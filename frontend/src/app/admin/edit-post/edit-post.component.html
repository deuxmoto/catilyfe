<div class="top-bar">
    <div class="top-bar-inner responsive-container">
        <a class="top-bar-back" (click)="closeEditPost()">
            <span class="fa fa-arrow-left"></span>
        </a>
        <h2 class="top-bar-title" [title]="title">Edit Post
            <span *ngIf="title">"{{title}}"</span>
        </h2>
    </div>
</div>

<div class="edit-post responsive-container" [ngSwitch]="state">


    <div *ngSwitchDefault [ngSwitch]="currentTab">

        <div class="tab-group">
            <button mat-button
                *ngFor="let tab of tabs"
                [ngClass]="{ active: currentTab == tab.value }"
                (click)="setCurrentTab(tab.value)">
                {{tab.text}}
            </button>
        </div>

        <div *ngSwitchCase="TabEnum.Metadata" class="tab-body">
            <form>
                <mat-form-field class="edit-post-field">
                    <input matInput placeholder="Title" name="title" [(ngModel)]="title">
                </mat-form-field>
                <div class="edit-post-fields-inline">
                    <mat-form-field class="edit-post-field">
                        <input matInput placeholder="Id" name="id" [(ngModel)]="id" disabled>
                    </mat-form-field>
                    <mat-form-field class="edit-post-field">
                        <input matInput placeholder="Slug" name="slug" [(ngModel)]="slug">
                    </mat-form-field>
                </div>
                <div class="edit-post-fields-inline">
                    <mat-form-field class="edit-post-field">
                        <input matInput placeholder="When Created" name="whenCreated" [(ngModel)]="whenCreated" disabled>
                    </mat-form-field>
                    <mat-form-field class="edit-post-field">
                        <input matInput placeholder="When Published" name="whenPublished" [(ngModel)]="whenPublished">
                    </mat-form-field>
                </div>
                <mat-form-field class="edit-post-field">
                    <textarea matInput mdTextareaAutosize placeholder="Description" name="description" [(ngModel)]="description"></textarea>
                </mat-form-field>
            </form>
        </div>
        <div *ngSwitchCase="TabEnum.Markdown" class="tab-body">
            <form>
                <mat-form-field class="edit-post-field">
                    <textarea matInput matTextareaAutosize placeholder="Write dank janx" name="postContent" [(ngModel)]="content"></textarea>
                </mat-form-field>
            </form>
        </div>
        <div *ngSwitchCase="TabEnum.MarkdownPreview" class="tab-body">
            <markdown-preview [markdown]="content"></markdown-preview>
        </div>
    </div>


    <div *ngSwitchCase="StateEnum.Loading">
        Loading...
    </div>

    <div class="error-message" *ngSwitchCase="StateEnum.Error">
        An error occurred, yo:
        <br> {{lastErrorMessage}}
    </div>

</div>

<div class="bottom-bar">
    <div class="bottom-bar-inner responsive-container">
        <span class="bottom-bar-item" style="color: rgba(0,0,0,0.5)">{{savingText}}</span>
        <button mat-button class="bottom-bar-item" [disabled]="state !== StateEnum.Normal" (click)="savePost()"> SAVE </button>
        <button mat-button class="bottom-bar-item" [disabled]="state !== StateEnum.Normal" (click)="closeEditPost()">CANCEL</button>
    </div>
</div>
